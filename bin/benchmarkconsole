#!/usr/bin/env python

import os
import sys
import subprocess

def usage():
    print "Usage: %s pathToResults distribuiton workload algorithm recordcount threads fieldsize" % sys.argv[0]
    sys.exit(1)

if len(sys.argv) < 8:
    usage()

pathresult = sys.argv[1]
print pathresult

distribution = sys.argv[2]
# distribution = "uniform"

workload = sys.argv[3]
print workload

type = sys.argv[4]

# Space of key
recordcount = sys.argv[5]

# Number of operaction
# operationcount = sys.argv[6]

thread = sys.argv[6]

fieldsize= sys.argv[7]


# ycsb_command = ["./bin/ycsb", "load_run", "myhashmap", "-P", "workloads/txworkloada", "-p", "myhashmap.verbose=false", "-p", "measurementtype=timeseries", "-p", "timeseries.granularity=20", "-p", "transaction.type=SI", "-p", "exportfile=/local/cj.gomes/results.csv", "-p", "exporter=com.yahoo.ycsb.measurements.exporter.CSVMeasurementsExporter", "-p", "recordcount=1000", "-p", "operationcount=10000000", "-p", "requestdistribution=uniform", "-p", "threadcount=32", "-p", "maxexecutiontime=40", "-s"]
# ./bin/ycsb load_run myhashmap -P workloads/txworkloada -p myhashmap.verbose=false -p measurementtype=timeseries -p timeseries.granularity=20 -p transaction.type=SI -p exportfile=/local/cj.gomes/results.csv -p exporter=com.yahoo.ycsb.measurements.exporter.CSVMeasurementsExporter -p recordcount=1000 -p operationcount=10000000 -p requestdistribution=uniform -p threadcount=32 -p maxexecutiontime=40 -s

ycsb_command = ["./bin/ycsb", "load_run", "myhashmap", "-P", "workloads/default", \
            "-p", "nameworkload="+workload, \
            "-p", "measurementtype=timeseries", \
            "-p", "timeseries.granularity=20", "-p", "transaction.type="+type, \
            "-p", "exportfile="+pathresult+"results.csv", \
            "-p", "exporter=com.yahoo.ycsb.measurements.exporter.CSVMeasurementsExporter", \
            "-p", "recordcount="+recordcount, "-p", "operationcount=100000000", \
            "-p", "threadcount="+thread, \
            "-p", "maxexecutiontime=30", \
            "-p", "requestdistribution="+distribution, \
            "-p", "fieldsize="+fieldsize, "-s"]
# print ycsb_command
subprocess.call(ycsb_command)